--Show customers that are not in the USA. 
SELECT customers.CustomerId
, customers.FirstName
, customers.LastName
,customers.country
FROM employees
LEFT JOIN customers
ON employees.EmployeeId = customers.SupportRepId
WHERE customers.country != 'USA'
;

-- Show customers that are only in France.
SELECT customers.CustomerId
, customers.FirstName
, customers.LastName
,customers.country
FROM employees
LEFT JOIN customers
ON employees.EmployeeId = customers.SupportRepId
WHERE customers.country IS 'France'
;

-- Show information for invoices that the customers is from France. 
SELECT customers.FirstName
, customers.LastName
,customers.country
, invoices.InvoiceId
, invoices.InvoiceDate
, invoices.BillingCountry
FROM employees
INNER JOIN customers
ON employees.EmployeeId = customers.SupportRepId
LEFT JOIN invoices
ON customers.customerid = invoices.customerid
WHERE customers.country IS 'France'
;

--Show the Employees who are Sales Agents.
SELECT*
FROM employees
WHERE title IS 'Sales Support Agent'
;

-- Provide a query that shows the invoices associated with each sales agent. The resulting table should include the Sales Agent's full name.
SELECT employees.Title
, employees.LastName
, employees.firstname
, invoices.invoiceid
, invoices.Total
FROM employees
INNER JOIN customers
ON employees.EmployeeId = customers.SupportRepId
LEFT JOIN invoices
ON customers.customerid = invoices.customerid
WHERE title IS 'Sales Support Agent'
;

-- Show the Invoice Total, Customer name, Country, and Sales Agent name for all invoices and customers.
SELECT customers.FirstName
, customers.lastname
, customers.Country
, employees.LastName
, employees.firstname
, invoices.Total
FROM employees
INNER JOIN customers
ON employees.EmployeeId = customers.SupportRepId
LEFT JOIN invoices
ON customers.customerid = invoices.customerid
WHERE title IS 'Sales Support Agent'
;

-- How many Invoices were there in 2009?
SELECT COUNT(invoices.invoicedate)
FROM employees
INNER JOIN customers
ON employees.EmployeeId = customers.SupportRepId
LEFT JOIN invoices
ON customers.customerid = invoices.customerid
WHERE invoices.invoicedate LIKE '%2009%'
;

-- What are the total sales for 2009?
SELECT SUM(invoices.total)
FROM employees
INNER JOIN customers
ON employees.EmployeeId = customers.SupportRepId
LEFT JOIN invoices
ON customers.customerid = invoices.customerid
WHERE invoices.invoicedate LIKE '%2009%'
;

-- Write a query that includes the purchased track name with each invoice line ID.
SELECT tracks.Name
, invoice_items.InvoiceLineId
FROM invoice_items
INNER JOIN tracks
ON invoice_items.TrackId = tracks.TrackId
;

-- Write a query that includes the purchased track name AND artist name with each invoice line ID.
SELECT tracks.Name
, artists.Name
, invoice_items.InvoiceLineId
FROM invoice_items
INNER JOIN tracks
ON invoice_items.TrackId = tracks.TrackId
INNER JOIN albums
ON artists.ArtistId = albums.ArtistId
INNER JOIN artists
ON albums.AlbumId = tracks.AlbumId
;

-- Provide a query that shows all the Tracks, and include the Album name, Media type, and Genre.
SELECT tracks.Name
, albums.title
, media_types.Name
, genres.name
FROM tracks
INNER JOIN media_types
ON tracks.MediaTypeId = media_types.MediaTypeId
INNER JOIN genres
ON tracks.GenreId = genres.GenreId
INNER JOIN albums
ON tracks.AlbumId = albums.albumid
INNER JOIN artists
ON albums.ArtistId = artists.ArtistId
;

-- Show the total sales made by each sales agent.
SELECT ROUND(SUM(invoices.total), 2) AS 'TotalSales'
, employees.FirstName
, employees.lastname 
FROM employees
INNER JOIN customers
ON employees.EmployeeId = customers.SupportRepId
LEFT JOIN invoices
ON customers.customerid = invoices.customerid
WHERE employees.Title IS 'Sales Support Agent'
GROUP BY employees.FirstName
;

-- Which sales agent made the most dollars in sales in 2009?
SELECT ROUND(SUM(invoices.total), 2) AS 'TotalSales'
, employees.FirstName
, employees.lastname 
FROM employees
INNER JOIN customers
ON employees.EmployeeId = customers.SupportRepId
LEFT JOIN invoices
ON customers.customerid = invoices.customerid
WHERE employees.Title IS 'Sales Support Agent'
AND invoices.InvoiceDate LIKE '%2009%'
GROUP BY employees.firstname
ORDER BY (round(sum(invoices.total), 2))  DESC LIMIT 1;
;

-- Find a unique/distinct list of billing countries from the Invoice table.
SELECT DISTINCT invoices.BillingCountry
FROM invoices
;

-- Show list of employees name and title. Also, show who they report to. 
SELECT employees.FirstName
, employees.LastName
, employees.reportsto
, employees.title
FROM employees
ORDER BY employees.ReportsTo
;

-- What are the years each employee was hired? Show them from earliest to most recent hired.
SELECT employees.firstname
, employees.lastname
, employees.HireDate
FROM employees
ORDER BY employees.HireDate
;
